<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Spare3.0</title>
	<link rel="stylesheet" media="screen" href="@{'/public/stylesheets/main.css'}">
    #{get 'moreStyles' /}
	<link rel="stylesheet" type="text/css" href="@{'/public/jquery-easyui-1.4.4/themes/default/easyui.css'}">
	<link rel="stylesheet" type="text/css" href="@{'/public/jquery-easyui-1.4.4/themes/icon.css'}">
	<!--  
	<script src="@{'/public/javascripts/jquery-1.6.4.min.js'}" type="text/javascript"></script>
	-->
    #{get 'moreScripts' /}
	
	<script type="text/javascript" src="@{'/public/jquery-easyui-1.4.4/jquery.min.js'}"></script> 
	<script type="text/javascript" src="@{'/public/jquery-easyui-1.4.4/jquery.easyui.min.js'}"></script>
	<!--自己的js文件-->
	<script type="text/javascript" src="@{'/public/javascripts/enableDragg.js'}"></script>
	<script type="text/javascript" src="@{'/public/javascripts/addToExperimentGrid.js'}"></script>
	<script type="text/javascript" src="@{'/public/javascripts/removeOperatorFromExpGrid.js'}"></script>
	<script type="text/javascript" src="@{'/public/javascripts/loadOperatorParameter.js'}"></script>
	<script type="text/javascript" src="@{'/public/javascripts/runExperiment.js'}"></script>
</head>

<body class="easyui-layout">
    <div data-options="region:'north',split:true" style="height:10%;">
		<div style="text-align:center;font-size:25px;font-weight:600;margin-top:10px;"><a href="@{Application.index()}" style="text-decoration:none;">DartSpoar3.0中医药数据挖掘平台</a></div>
	</div>
	
    <div data-options="region:'south',split:true" style="height:5%;">
		<div style="text-align:center;font-weight:600;margin-top:5px;">©版权所有 2014-2016，浙江大学计算机科学与技术学院CCNT实验室中国药小组，保留一切权利</div>	
	</div>
	
	<div data-options="region:'west',split:true" style="width:25%;">
		<div class="easyui-layout" data-options="fit:true">
			<div data-options="region:'center',title:'算子集'" style="">
				
				<div>
					<ul id="operatorTreeId"></ul>
				</div>
						
			</div>
			
			<div data-options="region:'south',title:'实验集',split:true" style="height:45%;">
			</div>
		</div>
	</div>
	
    <div data-options="region:'east',split:true" style="width:20%;">
		<div class="easyui-layout" data-options="fit:true">
			<div data-options="region:'center',title:'参数集'" style="">
				<div id="argumentSetID" style="margin-left:10px;color:blue;">
				</div>
			</div>
			
			<div data-options="region:'south',title:'运行|操作 日志',split:true" style="height:45%;">
				<div id="caozuoID" style="margin-left:10px;color:blue;">
				</div>
			</div>
		</div>
	</div>
	
    <div data-options="region:'center',split:true">
		<div class="easyui-layout" data-options="fit:true">
			<div data-options="region:'center',title:'主流程',split:true" style="">
			
				<div class="easyui-layout" data-options="fit:true">
					
					<div id="expertargetid01" data-options="region:'center',title:'实验面板一',split:true" style="">
						<div style="margin:5px">
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-ok'" onclick="runExperiment01()">运行</a>
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-remove'" onclick="removeOperatorFromExpGrid01()">删除</a>
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-add'" onclick="loadOperatorParameter01()">调参</a>
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-save'">保存</a>
						</div>
						
						<table id="experdgid01" class="easyui-datagrid" data-options="fitColumns:true,singleSelect:true,striped:true,rownumbers:true">
							<thead>
								<tr>
									<th data-options="field:'ckck',checkbox:true">ckck</th>
									<th data-options="field:'name',width:100">算法流程</th>
									<th data-options="field:'operator',width:100,hidden:true">算子实体</th>
								</tr>
							</thead>
						</table>
					</div>
					
					<!-- 
					<div id="expertargetid02" data-options="region:'east',title:'实验面板二',split:true" style="width:49%">
						<div style="margin:5px">
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-ok'">运行</a>
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-remove'" onclick="removeOperatorFromExpGrid02()">删除</a>
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-add'" onclick="loadOperatorParameter02()">调参</a>
							<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-save'">保存</a>
						</div>
						
						<table id="experdgid02" class="easyui-datagrid" data-options="fitColumns:true,singleSelect:true,striped:true,rownumbers:true">
							<thead>
								<tr>
									<th data-options="field:'ckck',checkbox:true">ckck</th>
									<th data-options="field:'name',width:100">算法流程</th>
									<th data-options="field:'operator',width:100,hidden:true">类名</th>
								</tr>
							</thead>
						</table>
					</div>
					 -->
				</div>
				
			</div>
			
			<div data-options="region:'south',title:'相关说明',split:true" style="height:30%;">
				
				<div id="XiangGuanShuoMing" style="margin-left:10px;color:blue;font-size:110%;">
					<p>1、拖动算子集中的算子到实验面板中，形成自己的实验流程；</p>
					<p>2、选中实验面板中的算子并点击调参，可以在参数集面板中设置算子参数；</p>
					<p>3、点击运行或者保存按钮，即可运行或者保存该实验；</p>
					<p>4、双击实验集面板中的某个实验，将会自动加载之前保存过的某个实验；</p>
				</div>
				
			</div>
			
		</div>
	</div>
	
	<!-->以下脚本文件</!-->
	<style type="text/css">
		.another-tree-node {
		}
		.dp{
            opacity:0.5;
            filter:alpha(opacity=50);
			z-index: 999;
        }
        .over{
            background:#FBEC88;
        }
	</style>
	
	<script>
		
		$(function(){
			
			//在html页面可以直接用Applicatoin加方法，但是在被包含的js文件中，则不行，必须在routes中配置好url
			$.getJSON('@{Application.getAllOperators()}',function(data,status){
				//构建算子树
				$('#operatorTreeId').tree({
					animate:true,
					lines:false,
					data: data
					//url:'/getAllOperators',
					//method:'get'
				});
				
				//允许拖动算子
				enableDragg();
			});
			
			//允许主流程模块接受拖动过来的算子
			$('#expertargetid01').droppable({
				onDragEnter:function(e,source){
	                $(source).draggable('proxy').css('border','1px solid red');
	                $(this).addClass('over');
	            },
	            onDragLeave:function(e,source){
	                $(source).draggable('proxy').css('border','1px solid #ccc');
	                $(this).removeClass('over');
	            },
				onDrop: function (e,source) {
					var node = $('#operatorTreeId').tree('getNode', source);  
					//$(this).append("<div>node.id:" + node.opclass + ", node.text:" + node.text + "</div>");  
					//var operator = node;
					//深度拷贝，保证表格中的唯一性
					var operator = $.extend(true, {}, node);
					var name = operator.text;
					addToExperimentGrid01(name,operator);
					$(this).removeClass('over');
				}  
			}); 
			
			$('#expertargetid02').droppable({
				onDragEnter:function(e,source){
	                $(source).draggable('proxy').css('border','1px solid red');
	                $(this).addClass('over');
	            },
	            onDragLeave:function(e,source){
	                $(source).draggable('proxy').css('border','1px solid #ccc');
	                $(this).removeClass('over');
	            },
				onDrop: function (e,source) {
					var node = $('#operatorTreeId').tree('getNode', source);  
					//$(this).append("<div>node.id:" + node.opclass + ", node.text:" + node.text + "</div>");  
					//var operator = node;
					//深度拷贝，保证表格中的唯一性
					var operator = $.extend(true, {}, node);
					var name = operator.text;
					addToExperimentGrid02(name,operator);
					$(this).removeClass('over');
				}  
			});
			
			
		});
		
	</script>
	
</body>
</html>

